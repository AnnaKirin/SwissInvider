<!--
  V 0) Git commit 
 V  1)Na przycisk pojawia sie gra i canvas
    2)Trzeba bedzie sie bronic przed latajacymi kawalkami sera
  V 3)Wstawic w tlo poruszajace sie chmurki
  V  - kilka chmurek z roznymi predkosciami
     - chmury dodac do tablicy
  V  - Jest noc, ksiezyc pulsuje
    4) Zbieranie punktow: trzy trafienia serem - koniec gry
    5) Responsywny canvas
 V 6) zeby ufuludek nie znikal za krawedziazeby ufuludek nie znikal za krawedzia
 V 7) przerobic playera na klase
 ?) Jak lepiej cos poprawiac, bo zaczynasz od jednej rzeczy i potem wszystko sie psuje - Mozna patrzec na zmiany w source tree poki nie bylo commitow
 V 8) Dodac pocisk zeby sie pojawial na space i spadal w dol
 V 9) add txt to gitignore
 V 10) Laser tam gdzie statek
   11) Laser z krowa, zeby krowa zmieniala status na inactive
   12) Zycie playera dodac jak trafisz krowe
   13) Duzy przycisk start, w tle chmury, gwiazdy
 V 14) Zrobic w tle przesuwny obrazek z gwiazdami, zeby zjezdzal wlewo
   15) Naprawic szew na obrazkach tla
   16) Sprawdzac stan czy jest menu czy gra zeby nic sie nie rysowalo
-->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Swiss invider</title>

    <link rel="stylesheet" href="assets/css/style.css" />

    <script src="assets/js/random.js"></script>
    <script src="assets/js/player.js"></script>
    <script src="assets/js/cow.js"></script>
    <script src="assets/js/cloud.js"></script>
    <script src="assets/js/game.js"></script>
    <script src="assets/js/moon.js"></script>
    <script src="assets/js/laser.js"></script>
    <script src="assets/js/background.js"></script>
    <script src="assets/js/navigation.js"></script>
    <script>
      window.addEventListener("load", () => {
        canvas = document.getElementById("gameCanvas");
        game = new Game(canvas);

        game.preload();
        game.executeOnGameOver(onGameOver);
        console.log("dupa");

        document
          .getElementById("playButton")
          .addEventListener("click", onStart);

        document.getElementById("saveButton").addEventListener("click", () => {
          let savedElement = document.getElementById("playerNameInput").value;

          let player = { name: savedElement, points: game.getPoints() };
          let json = localStorage.getItem("players");

          // let playersFromStorage;
          // if (!!json) {
          //   playersFromStorage = JSON.parse(json);
          // } else {
          //   playersFromStorage = [];
          // }

          // let playersFromStorage =  ( .... ) ? .... : ..... operator tenarny
          // (!!json)? JSON.parse(json): [];

          let playersFromStorage = [];
          function fillPlayers() {
            if (!!json) {
              playersFromStorage = JSON.parse(json);
              playersFromStorage.push(player);
              console.log(
                playersFromStorage.sort((a, b) => b.points - a.points)
              );
              playersFromStorage.sort((a, b) => b.points - a.points);
              playersFromStorage.splice(6);
            } else {
              playersFromStorage = [];
              playersFromStorage.push(player);
            }
            return playersFromStorage;
          }
          // [].slice.call(playersFromStorage).sort(function(a,b)
          localStorage.setItem("players", JSON.stringify(fillPlayers()));

          loadPlayersTable();
        });

        addEventListener("keydown", onKeyDown);
        addEventListener("keyup", onKeyUp);

        function loadPlayersTable() {
          let playersTable = document.getElementById("playersTable");
          let json = localStorage.getItem("players");
          playersTable.innerHTML = "";

          // let players = JSON.parse(localStorage.getItem("players"));
          let players = !!json ? JSON.parse(json) : [];

          players.forEach((player) => {
            let playersTableElement = document.createElement("li");
            playersTableElement.innerHTML =
              player.name + " - " + player.points + " points";
            playersTable.appendChild(playersTableElement);
          });
        }
        loadPlayersTable();
      });
    </script>
  </head>

  <body>
    <div id="mainContainer">
      <div id="controlContainer">
        <h1>Swiss invader</h1>

        <div id="gameRating">
          <div id="saveButtonContainer">
            <input
              id="playerNameInput"
              required
              minlength="4"
              maxlength="15"
              size="15"
              value="put your name"
            />
            <button id="saveButton">Save</button>
          </div>
          <ul id="playersTable"></ul>
        </div>
      </div>

      <div class="container" id="gameContainer" style="visibility: visible">
        <canvas id="gameCanvas"> </canvas>
        <button id="playButton">Start game</button>
      </div>
    </div>
  </body>
</html>
